<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whitelist Management System</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Mobile Menu Toggle -->
    <button class="menu-toggle" onclick="ui.toggleMenu()">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
    </button>

    <!-- Sidebar Overlay for Mobile -->
    <div class="sidebar-overlay"></div>

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="nav-section">
            <h2>เมนูหลัก</h2>
            <div class="nav-item active" data-page="dashboard">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                </svg>
                Dashboard
            </div>
            <div class="nav-item" data-page="users">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
                ผู้ใช้งาน
            </div>
            <div class="nav-item" data-page="services">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
                บริการ
            </div>
        </div>
        
        <div class="nav-section">
            <h2>การตั้งค่า</h2>
            <div class="nav-item" data-page="integrations">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a2 2 0 110-4h1a1 1 0 001-1V7a1 1 0 011-1h3a1 1 0 001-1V4z" />
                </svg>
                Integrations
            </div>
            <div class="nav-item" data-page="keys">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />
                </svg>
                API Keys
            </div>
            <div class="nav-item" data-page="lua-scripts">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
                </svg>
                Lua Scripts
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Page -->
        <div id="dashboard" class="page active">
            <div class="page-header">
                <h1>Dashboard</h1>
                <p>ภาพรวมของระบบ Whitelist Management</p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <h3>ผู้ใช้งานทั้งหมด</h3>
                    <div class="value" id="totalUsers">0</div>
                </div>
                <div class="stat-card">
                    <h3>ผู้ใช้งานที่ Active</h3>
                    <div class="value" id="activeUsers">0</div>
                </div>
                <div class="stat-card">
                    <h3>รออนุมัติ</h3>
                    <div class="value" id="pendingUsers">0</div>
                </div>
                <div class="stat-card">
                    <h3>บริการทั้งหมด</h3>
                    <div class="value" id="totalServices">0</div>
                </div>
            </div>

            <div class="form-section">
                <h2>กิจกรรมล่าสุด</h2>
                <p style="color: #94a3b8;">ยังไม่มีกิจกรรม</p>
            </div>
        </div>

        <!-- Users Page -->
        <div id="users" class="page">
            <div class="page-header">
                <h1>จัดการผู้ใช้งาน</h1>
                <p>เพิ่ม แก้ไข และลบผู้ใช้งานใน Whitelist</p>
            </div>

            <div class="form-section">
                <h2>เพิ่มผู้ใช้งานใหม่</h2>
                <form onsubmit="addUser(event)">
                    <div class="form-group">
                        <label>ชื่อผู้ใช้งาน</label>
                        <input type="text" id="username" placeholder="เช่น john_doe" required>
                    </div>
                    <div class="form-group">
                        <label>User ID</label>
                        <input type="text" id="userId" placeholder="เช่น USER001" required>
                    </div>
                    <div class="form-group">
                        <label>บริการ</label>
                        <select id="service" required>
                            <option value="">เลือกบริการ</option>
                            <option value="Discord">Discord</option>
                            <option value="API">API</option>
                            <option value="Web">Web</option>
                            <option value="Mobile">Mobile</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">เพิ่มผู้ใช้งาน</button>
                </form>
            </div>

            <div class="form-section">
                <h2>รายการผู้ใช้งาน</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ชื่อผู้ใช้งาน</th>
                                <th>User ID</th>
                                <th>บริการ</th>
                                <th>สถานะ</th>
                                <th>เพิ่มเมื่อ</th>
                                <th>การจัดการ</th>
                            </tr>
                        </thead>
                        <tbody id="userTable">
                            <!-- Users will be rendered here by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Services Page -->
        <div id="services" class="page">
            <div class="page-header">
                <h1>จัดการบริการ</h1>
                <p>สร้างและจัดการบริการต่างๆ</p>
            </div>

            <div class="form-section">
                <h2>สร้างบริการใหม่</h2>
                <form onsubmit="addService(event)">
                    <div class="form-group">
                        <label>ชื่อบริการ</label>
                        <input type="text" placeholder="เช่น Discord Bot, Web API" required>
                    </div>
                    <div class="form-group">
                        <label>คำอธิบาย</label>
                        <textarea placeholder="อธิบายรายละเอียดของบริการ" rows="3" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Endpoint URL</label>
                        <input type="url" placeholder="https://api.example.com" required>
                    </div>
                    <button type="submit" class="btn btn-primary">สร้างบริการ</button>
                </form>
            </div>
        </div>

        <!-- Integrations Page -->
        <div id="integrations" class="page">
            <div class="page-header">
                <h1>Integrations</h1>
                <p>เชื่อมต่อกับบริการภายนอก</p>
            </div>

            <div class="form-section">
                <h2>Provider Management</h2>
                <form onsubmit="addProvider(event)">
                    <div class="form-group">
                        <label>Provider Name</label>
                        <input type="text" placeholder="เช่น Discord, Slack, GitHub" required>
                    </div>
                    <div class="form-group">
                        <label>API Endpoint</label>
                        <input type="url" placeholder="https://api.provider.com" required>
                    </div>
                    <div class="form-group">
                        <label>Authentication Token</label>
                        <input type="password" placeholder="ใส่ Token หรือ API Key" required>
                    </div>
                    <button type="submit" class="btn btn-primary">เพิ่ม Provider</button>
                </form>
            </div>

            <div class="form-section">
                <h2>Connected Integrations</h2>
                <input type="text" id="integrationSearch" placeholder="ค้นหา Integration..." style="width: 100%; padding: 0.75rem; background: #0f172a; border: 1px solid #334155; border-radius: 0.5rem; color: #e2e8f0; margin-bottom: 1.5rem;">
                
                <div class="integration-grid">
                    <div class="integration-card">
                        <h3>
                            Discord Bot
                            <span class="status online"></span>
                        </h3>
                        <p style="color: #94a3b8; margin-bottom: 1rem;">ระบบตรวจสอบ Whitelist สำหรับ Discord</p>
                        <p><strong>Endpoint:</strong> https://discord.com/api</p>
                        <p><strong>Status:</strong> Connected</p>
                        <div style="margin-top: 1rem;">
                            <button class="btn btn-secondary btn-sm">แก้ไข</button>
                            <button class="btn btn-danger btn-sm">ยกเลิกการเชื่อมต่อ</button>
                        </div>
                    </div>

                    <div class="integration-card">
                        <h3>
                            GitHub Webhook
                            <span class="status online"></span>
                        </h3>
                        <p style="color: #94a3b8; margin-bottom: 1rem;">แจ้งเตือนเมื่อมีการอัพเดท Whitelist</p>
                        <p><strong>Endpoint:</strong> https://api.github.com</p>
                        <p><strong>Status:</strong> Active</p>
                        <div style="margin-top: 1rem;">
                            <button class="btn btn-secondary btn-sm">แก้ไข</button>
                            <button class="btn btn-danger btn-sm">ลบ</button>
                        </div>
                    </div>

                    <div class="integration-card">
                        <h3>
                            Internal API
                            <span class="status offline"></span>
                        </h3>
                        <p style="color: #94a3b8; margin-bottom: 1rem;">API ภายใน</p>
                        <p><strong>Endpoint:</strong> https://internal-api.local</p>
                        <p><strong>Status:</strong> Offline</p>
                        <div style="margin-top: 1rem;">
                            <button class="btn btn-secondary btn-sm">แก้ไข</button>
                            <button class="btn btn-danger btn-sm">ลบ</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Keys Page -->
        <div id="keys" class="page">
            <div class="page-header">
                <h1>API Keys</h1>
                <p>จัดการ API Keys สำหรับการเข้าถึงระบบ</p>
            </div>

            <div class="form-section">
                <h2>สร้าง API Key ใหม่</h2>
                <form onsubmit="generateKey(event)">
                    <div class="form-group">
                        <label>ชื่อ Key</label>
                        <input type="text" id="keyName" placeholder="เช่น Production Key, Development Key" required>
                    </div>
                    <div class="form-group">
                        <label>สิทธิ์การเข้าถึง</label>
                        <select id="keyPermission">
                            <option value="read">Read Only</option>
                            <option value="write">Read & Write</option>
                            <option value="admin">Full Admin</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">สร้าง API Key</button>
                </form>
            </div>

            <div class="form-section">
                <h2>API Keys ที่มีอยู่</h2>
                <div id="apiKeysList">
                    <!-- API Keys will be rendered here by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Lua Scripts Page -->
        <div id="lua-scripts" class="page">
            <div class="page-header">
                <h1>Lua Scripts</h1>
                <p>จัดการ Lua Scripts สำหรับการตรวจสอบและอนุมัติ</p>
            </div>

            <div class="form-section">
                <h2>เขียน Lua Script</h2>
                <div class="form-group">
                    <label>ชื่อ Script</label>
                    <input type="text" id="scriptName" placeholder="เช่น Whitelist Checker, Auto Approve">
                </div>
                <div class="form-group">
                    <label>Script Code</label>
                    <textarea id="scriptCode" style="font-family: 'Courier New', monospace; min-height: 300px;">-- Lua Whitelist Checker Script
local whitelist = {}

function checkWhitelist(userId)
    if whitelist[userId] then
        return true, "User is whitelisted"
    else
        return false, "User not found in whitelist"
    end
end

function addToWhitelist(userId, username)
    whitelist[userId] = {
        username = username,
        addedAt = os.time(),
        status = "active"
    }
    return true, "User added successfully"
end

function removeFromWhitelist(userId)
    if whitelist[userId] then
        whitelist[userId] = nil
        return true, "User removed successfully"
    else
        return false, "User not found"
    end
end

return {
    check = checkWhitelist,
    add = addToWhitelist,
    remove = removeFromWhitelist
}</textarea>
                </div>
                <button class="btn btn-primary" onclick="saveScript()">บันทึก Script</button>
                <button class="btn btn-secondary" onclick="testScript()">ทดสอบ Script</button>
            </div>

            <div class="form-section">
                <h2>Scripts ที่บันทึกไว้</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ชื่อ Script</th>
                                <th>สร้างเมื่อ</th>
                                <th>แก้ไขล่าสุด</th>
                                <th>สถานะ</th>
                                <th>การจัดการ</th>
                            </tr>
                        </thead>
                        <tbody id="scriptsTable">
                            <!-- Scripts will be rendered here by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <script src="main.js"></script>
</body>
</html>
